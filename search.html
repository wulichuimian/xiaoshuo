<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>小说阅读</title>
		<link rel="stylesheet" type="text/css" href="css/normalize.css" />
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<link rel="stylesheet" type="text/css" href="css/search.css"/>
		<script src="./js/index.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/jquery-1.11.2.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="./js/ajax.js" type="text/javascript" charset="utf-8"></script>
		<style>
			body {
				height: 100vh;
			}
			article{
				height: 300px;
			}
		</style>
	</head>
	<body>
		<script>
			$(function() {
				footer();
				//获取要搜索的内容；
				let search = $(".inSearch").val();
				//点击返回上一个浏览记录；
				$("header").children().eq(0).click(function() {
					window.history.go(-1);
				})
				//点击搜索按钮，跳转到search2.html页面；
				$("header").children("div").click(function(){
					window.location.href = `search2.html?search=${search}`;
				});
				//当键盘弹起时运行；
				$(".inSearch").keyup(function(e){
					//获取要搜索的内容；
					search = $(this).val();
					//如果搜索栏不为空就进行搜索；
					if(search){
						//当按下回车键时跳转到search2.html页面；
						if(e.keyCode == 13){
							window.location.href = `search2.html?search=${search}`;
						}
						$ajax({
							method: "post",
							url: "search.php",
							data: {
								search:search,
							},
							success: function(resul) {
								var obj = JSON.parse(resul);
								console.log(obj);
								var str = '';
								for(let i =0;i<obj.length;i++){
									//这是搜索提示栏的内容；
									str += `<li>
										<i>&#xe656;</i><a href="booksIntroduce.html?id=${obj[i].id}&title=${obj[i].title}">${obj[i].title}</a>
									</li>`;
								}
								//把搜索提示栏插入到页面中去；
								$(".search1").children().eq(0).html(str);
							},
							error: function(mag) {
								console.log(mag);
							}
						});
					}
				})
			})
		</script>
		<header>
			<i>&#xe61f;</i>
			<input type="text" class="inSearch" placeholder="搜索书名、作者、分类">
			<div style="font-size: 30px;line-height: 25px;">搜索</div>
		</header>
		<div class="search1">
			<ul></ul>
		</div>
		<article></article>
		<footer id="footer"></footer>
	</body>
</html>
